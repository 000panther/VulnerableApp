package org.sasanlabs.service.vulnerability.jwt.impl;

import org.sasanlabs.service.vulnerability.jwt.IJWTValidator;
import org.springframework.stereotype.Component;

import io.jsonwebtoken.Claims;
import io.jsonwebtoken.Jwts;

/**
 * JWTValidator is used for validating jwt token. it will contain various
 * implementations of validating libraries.
 * 
 * @author KSASAN preetkaran20@gmail.com
 */
@Component
public class JWTValidator implements IJWTValidator{

	@Override
	public boolean validateBasedOnJWT(String token) {
		try {
		Claims claims = Jwts.parser()
	            .setSigningKey(LibBasedJWTGenerator.SIGNING_KEY_HS256)
	            .parseClaimsJws(token).getBody();
		} catch(Exception ex) {
			return false;
		}
	    return true;
	}

	@Override
	public boolean validateBasedOnJWT(String key, String algorithm, String token) {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public boolean validateBasedOnAuth0JWT(String key, String token) {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public boolean validateBasedOnAuth0JWT(String key, String algorithm, String token) {
		// TODO Auto-generated method stub
		return false;
	}

}
